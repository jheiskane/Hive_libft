size_t definitions still a bit unclear?
Did not use unsigned char in the prototypes?